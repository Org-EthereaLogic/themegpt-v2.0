<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThemeGPT Preview</title>
  <style>
    /* === CSS Variables (matches theme-injector.ts) === */
    :root {
      --cgpt-bg: #1E1E1E;
      --cgpt-surface: #252526;
      --cgpt-text: #D4D4D4;
      --cgpt-text-muted: #808080;
      --cgpt-border: #3C3C3C;
      --cgpt-accent: #569CD6;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--cgpt-bg);
      color: var(--cgpt-text);
      line-height: 1.5;
    }

    /* === Layout === */
    .app {
      display: grid;
      grid-template-columns: 260px 1fr;
      height: 100vh;
    }

    .app.panel-hidden { grid-template-columns: 260px 1fr; }

    /* === Sidebar === */
    .sidebar {
      background: var(--cgpt-surface);
      border-right: 1px solid var(--cgpt-border);
      display: flex;
      flex-direction: column;
      padding: 12px;
    }

    .new-chat-btn {
      background: transparent;
      border: 1px solid var(--cgpt-border);
      color: var(--cgpt-text);
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s;
    }

    .new-chat-btn:hover { background: var(--cgpt-border); }

    .chat-list { flex: 1; margin-top: 16px; }

    .chat-item {
      padding: 10px 12px;
      border-radius: 6px;
      color: var(--cgpt-text-muted);
      cursor: pointer;
      margin-top: 4px;
      font-size: 14px;
    }

    .chat-item.active, .chat-item:hover {
      background: var(--cgpt-border);
      color: var(--cgpt-text);
    }

    .sidebar-footer {
      padding-top: 12px;
      border-top: 1px solid var(--cgpt-border);
      color: var(--cgpt-text-muted);
      font-size: 12px;
    }

    /* === Main Content === */
    .main-content {
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    .chat-area {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
    }

    /* === Messages === */
    .message {
      display: flex;
      gap: 16px;
      margin-bottom: 24px;
      max-width: 768px;
      margin-left: auto;
      margin-right: auto;
    }

    .message-avatar {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
      font-size: 14px;
    }

    .message.user .message-avatar {
      background: var(--cgpt-accent);
      color: var(--cgpt-bg);
    }

    .message.assistant .message-avatar {
      background: var(--cgpt-surface);
      border: 1px solid var(--cgpt-border);
    }

    .message-content { flex: 1; }
    .message-content p { margin: 0 0 12px; }

    .message-content pre {
      background: var(--cgpt-surface);
      border: 1px solid var(--cgpt-border);
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      margin: 12px 0;
    }

    .message-content code {
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 14px;
      color: var(--cgpt-accent);
    }

    .message-content pre code { color: var(--cgpt-text); }

    /* === Composer === */
    .composer {
      padding: 16px 24px 24px;
      border-top: 1px solid var(--cgpt-border);
    }

    .composer-container {
      max-width: 768px;
      margin: 0 auto;
      display: flex;
      gap: 12px;
      background: var(--cgpt-surface);
      border: 1px solid var(--cgpt-border);
      border-radius: 12px;
      padding: 12px 16px;
      align-items: flex-end;
    }

    .composer-input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--cgpt-text);
      resize: none;
      font-family: inherit;
      font-size: 16px;
      line-height: 1.5;
      min-height: 24px;
      max-height: 200px;
    }

    .composer-input::placeholder { color: var(--cgpt-text-muted); }
    .composer-input:focus { outline: none; }

    .send-btn {
      background: var(--cgpt-accent);
      border: none;
      border-radius: 6px;
      padding: 8px;
      cursor: pointer;
      color: var(--cgpt-bg);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* === Selection & Focus === */
    ::selection { background-color: color-mix(in srgb, var(--cgpt-accent) 35%, transparent); }
    *:focus-visible { outline: 2px solid var(--cgpt-accent); outline-offset: 2px; }

    /* === Scrollbar === */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--cgpt-bg); }
    ::-webkit-scrollbar-thumb { background: var(--cgpt-border); border-radius: 4px; }

    /* === Pattern & Overlay placeholders === */
    body::before, body::after {
      content: '';
      position: fixed;
      inset: 0;
      pointer-events: none;
    }
    body::before { z-index: 0; }
    body::after { z-index: 1; }

    /* === Effects Layer === */
    .themegpt-effects-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    /* === Theme Panel === */
    .theme-panel {
      position: fixed;
      right: 0;
      top: 0;
      bottom: 0;
      width: 320px;
      background: #111;
      border-left: 1px solid #333;
      padding: 16px;
      overflow-y: auto;
      z-index: 1000;
      color: #fff;
      font-size: 13px;
    }

    .theme-panel.hidden { display: none; }
    .theme-panel h2 { margin-bottom: 12px; font-size: 16px; }
    .theme-panel h3 { margin: 16px 0 8px; font-size: 13px; color: #888; }

    .theme-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
    }

    .theme-btn {
      padding: 8px 6px;
      border: 2px solid transparent;
      border-radius: 6px;
      cursor: pointer;
      font-size: 10px;
      text-align: left;
      transition: border-color 0.2s, transform 0.1s;
    }

    .theme-btn:hover { transform: scale(1.02); }
    .theme-btn.active { border-color: #7ECEC5; }
    .theme-btn .name { font-weight: 600; margin-bottom: 4px; }
    .theme-btn .accent-bar { height: 3px; border-radius: 2px; margin-top: 4px; }
    .theme-btn .effects-badge {
      font-size: 8px;
      background: rgba(255,255,255,0.2);
      padding: 1px 4px;
      border-radius: 2px;
      margin-top: 4px;
      display: inline-block;
    }

    .current-theme {
      margin-top: 16px;
      padding: 12px;
      background: #222;
      border-radius: 8px;
    }

    .quality-panel {
      margin-top: 16px;
      padding: 12px;
      background: #1a1a1a;
      border-radius: 8px;
    }

    .quality-panel h4 { margin-bottom: 8px; font-size: 12px; }

    .check-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 0;
      font-size: 11px;
    }

    .check-item.pass { color: #4ade80; }
    .check-item.fail { color: #f87171; }

    .controls {
      margin-top: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .ctrl-btn {
      padding: 10px;
      background: #7ECEC5;
      color: #111;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 12px;
    }

    .ctrl-btn:hover { opacity: 0.9; }
    .ctrl-btn.secondary { background: #333; color: #fff; }

    .shortcuts {
      margin-top: 16px;
      font-size: 10px;
      color: #666;
    }

    .shortcuts kbd {
      background: #333;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
    }

    .theme-stats {
      margin-top: 12px;
      padding: 8px;
      background: #1a1a1a;
      border-radius: 6px;
      font-size: 11px;
      color: #888;
    }

    .theme-stats span { color: #7ECEC5; font-weight: 600; }
  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <button class="new-chat-btn">+ New chat</button>
      <nav class="chat-list">
        <div class="chat-item active">Theme preview session</div>
        <div class="chat-item">Previous conversation</div>
        <div class="chat-item">Code review discussion</div>
      </nav>
      <div class="sidebar-footer">user@themegpt.app</div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      <section class="chat-area">
        <article class="message user">
          <div class="message-avatar">U</div>
          <div class="message-content">
            <p>How do I create a responsive navbar in React?</p>
          </div>
        </article>
        <article class="message assistant">
          <div class="message-avatar">A</div>
          <div class="message-content">
            <p>Here's a simple approach using flexbox and media queries:</p>
            <pre><code>const Navbar = () => {
  const [isOpen, setIsOpen] = useState(false);

  return (
    &lt;nav className="navbar"&gt;
      &lt;Logo /&gt;
      &lt;button onClick={() => setIsOpen(!isOpen)}&gt;
        Menu
      &lt;/button&gt;
      &lt;NavLinks isOpen={isOpen} /&gt;
    &lt;/nav&gt;
  );
};</code></pre>
            <p>The key is using <code>display: flex</code> with <code>justify-content: space-between</code> for the desktop layout, then switching to a column layout on mobile.</p>
          </div>
        </article>
        <article class="message user">
          <div class="message-avatar">U</div>
          <div class="message-content">
            <p>Can you show me the CSS for that?</p>
          </div>
        </article>
        <article class="message assistant">
          <div class="message-avatar">A</div>
          <div class="message-content">
            <p>Here's the accompanying CSS with a mobile breakpoint:</p>
            <pre><code>.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 2rem;
  background: var(--surface);
}

@media (max-width: 768px) {
  .navbar {
    flex-direction: column;
  }
  .nav-links {
    display: none;
  }
  .nav-links.open {
    display: flex;
    flex-direction: column;
  }
}</code></pre>
          </div>
        </article>
      </section>

      <footer class="composer">
        <div class="composer-container">
          <textarea class="composer-input" placeholder="Message ChatGPT..." rows="1"></textarea>
          <button class="send-btn">
            <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
            </svg>
          </button>
        </div>
      </footer>
    </main>
  </div>

  <!-- Effects container (for animated elements) -->
  <div id="themegpt-effects" class="themegpt-effects-layer"></div>

  <!-- THEME PANEL -->
  <aside class="theme-panel" id="themePanel">
    <h2>ThemeGPT Preview</h2>

    <div class="theme-stats">
      Total: <span id="totalCount">0</span> themes |
      Free: <span id="freeCount">0</span> |
      Premium: <span id="premiumCount">0</span>
    </div>

    <h3>Free Themes (8)</h3>
    <div class="theme-grid" id="freeThemes"></div>

    <h3>Premium Themes (16)</h3>
    <div class="theme-grid" id="premiumThemes"></div>

    <div class="current-theme">
      <strong>Active:</strong> <span id="themeName">-</span>
      <div id="themeInfo" style="margin-top:8px;font-size:11px;color:#888"></div>
    </div>

    <div class="quality-panel">
      <h4>Quality Checks</h4>
      <div id="qualityChecks"></div>
    </div>

    <div class="controls">
      <button class="ctrl-btn" id="exportBtn">Export Theme JSON</button>
      <button class="ctrl-btn secondary" id="toggleEffectsBtn">Toggle Effects</button>
      <button class="ctrl-btn secondary" id="hideBtn">Hide Panel (Ctrl+H)</button>
    </div>

    <div class="shortcuts">
      <p><kbd>Ctrl</kbd>+<kbd>H</kbd> Toggle panel</p>
      <p><kbd>Ctrl</kbd>+<kbd>E</kbd> Export to console</p>
      <p><kbd>&larr;</kbd>/<kbd>&rarr;</kbd> Navigate themes</p>
    </div>
  </aside>

  <script>
    // === THEME DATA (synced from packages/shared/src/index.ts) ===
    const THEMES = [
      // FREE THEMES (8)
      { id: 'vscode-dark-plus', name: 'VS Code Dark+', category: 'core', colors: { '--cgpt-bg': '#1E1E1E', '--cgpt-surface': '#252526', '--cgpt-text': '#D4D4D4', '--cgpt-text-muted': '#808080', '--cgpt-border': '#3C3C3C', '--cgpt-accent': '#569CD6' }, isPremium: false, noiseOverlay: true, pattern: { type: 'dots', opacity: 0.03, size: 1 } },
      { id: 'solarized-dark', name: 'Solarized Dark', category: 'core', colors: { '--cgpt-bg': '#002B36', '--cgpt-surface': '#073642', '--cgpt-text': '#839496', '--cgpt-text-muted': '#657B83', '--cgpt-border': '#094959', '--cgpt-accent': '#2AA198' }, isPremium: false, noiseOverlay: true, pattern: { type: 'grid', opacity: 0.04, size: 1.5 } },
      { id: 'dracula', name: 'Dracula', category: 'core', colors: { '--cgpt-bg': '#282A36', '--cgpt-surface': '#343746', '--cgpt-text': '#F8F8F2', '--cgpt-text-muted': '#6272A4', '--cgpt-border': '#44475A', '--cgpt-accent': '#BD93F9' }, isPremium: false, glowOverlay: true, pattern: { type: 'dots', opacity: 0.03, size: 1 } },
      { id: 'monokai-pro', name: 'Monokai Pro', category: 'core', colors: { '--cgpt-bg': '#2D2A2E', '--cgpt-surface': '#403E41', '--cgpt-text': '#FCFCFA', '--cgpt-text-muted': '#939293', '--cgpt-border': '#49474A', '--cgpt-accent': '#FFD866' }, isPremium: false, noiseOverlay: true, pattern: { type: 'dots', opacity: 0.03, size: 1 } },
      { id: 'one-dark', name: 'One Dark', category: 'core', colors: { '--cgpt-bg': '#282C34', '--cgpt-surface': '#21252B', '--cgpt-text': '#ABB2BF', '--cgpt-text-muted': '#5C6370', '--cgpt-border': '#3E4451', '--cgpt-accent': '#61AFEF' }, isPremium: false, glowOverlay: true, pattern: { type: 'dots', opacity: 0.03, size: 1 } },
      { id: 'aurora-borealis', name: 'Aurora Borealis', category: 'core', colors: { '--cgpt-bg': '#0A1628', '--cgpt-surface': '#0F2137', '--cgpt-text': '#E0F7FA', '--cgpt-text-muted': '#80DEEA', '--cgpt-border': '#164E63', '--cgpt-accent': '#00E5CC' }, isPremium: false, glowOverlay: true, pattern: { type: 'stars', opacity: 0.04, size: 1 } },
      { id: 'sunset-blaze', name: 'Sunset Blaze', category: 'core', colors: { '--cgpt-bg': '#1A0A14', '--cgpt-surface': '#2D1220', '--cgpt-text': '#FFF5F0', '--cgpt-text-muted': '#FFAB91', '--cgpt-border': '#4A1A2E', '--cgpt-accent': '#FF6B4A' }, isPremium: false, glowOverlay: true, pattern: { type: 'dots', opacity: 0.03, size: 1 } },
      { id: 'electric-dreams', name: 'Electric Dreams', category: 'core', colors: { '--cgpt-bg': '#0D0221', '--cgpt-surface': '#150634', '--cgpt-text': '#F5E6FF', '--cgpt-text-muted': '#D4AAFF', '--cgpt-border': '#3D1A6D', '--cgpt-accent': '#FF2E97' }, isPremium: false, glowOverlay: true, pattern: { type: 'grid', opacity: 0.04, size: 2 } },

      // PREMIUM THEMES - Christmas Collection (6)
      { id: 'cozy-cabin-christmas', name: 'Cozy Cabin Christmas', category: 'christmas', colors: { '--cgpt-bg': '#140E0A', '--cgpt-surface': '#1E1410', '--cgpt-text': '#F9FAFB', '--cgpt-text-muted': '#E5E7EB', '--cgpt-border': '#4B2E23', '--cgpt-accent': '#D97757' }, isPremium: true, noiseOverlay: true, effects: { treeSilhouettes: { enabled: true, style: 'christmas', density: 'few', withOrnaments: true }, animatedSnowfall: { enabled: true, density: 'light', speed: 'slow', style: 'gentle' } } },
      { id: 'frosted-windowpane', name: 'Frosted Windowpane', category: 'christmas', colors: { '--cgpt-bg': '#F5F7FB', '--cgpt-surface': '#FFFFFF', '--cgpt-text': '#0F172A', '--cgpt-text-muted': '#4B5563', '--cgpt-border': '#D1D5DB', '--cgpt-accent': '#3B82F6' }, isPremium: true, effects: { animatedSnowfall: { enabled: true, density: 'medium', speed: 'slow', snowColor: '#B8D4E8', style: 'gradient' }, seasonalDecorations: { frostedGlass: true } } },
      { id: 'midnight-evergreen', name: 'Midnight Evergreen', category: 'christmas', colors: { '--cgpt-bg': '#020817', '--cgpt-surface': '#07120E', '--cgpt-text': '#F9FAFB', '--cgpt-text-muted': '#E5E7EB', '--cgpt-border': '#14532D', '--cgpt-accent': '#22C55E' }, isPremium: true, noiseOverlay: true, effects: { treeSilhouettes: { enabled: true, style: 'pine', density: 'forest' }, twinklingStars: { enabled: true, count: 'medium' }, ambientEffects: { fogRising: true } } },
      { id: 'candy-cane-chat', name: 'Candy Cane Chat', category: 'christmas', colors: { '--cgpt-bg': '#FDF2F2', '--cgpt-surface': '#FFFFFF', '--cgpt-text': '#111827', '--cgpt-text-muted': '#4B5563', '--cgpt-border': '#FECACA', '--cgpt-accent': '#DC2626' }, isPremium: true, noiseOverlay: true, effects: { seasonalDecorations: { candyCaneFrame: true, sparkleOverlay: true, sparkleColor: '#dc2626' } } },
      { id: 'silent-night-starfield', name: 'Silent Night (Starfield)', category: 'christmas', colors: { '--cgpt-bg': '#020617', '--cgpt-surface': '#02081C', '--cgpt-text': '#F9FAFB', '--cgpt-text-muted': '#CBD5F5', '--cgpt-border': '#1D4ED8', '--cgpt-accent': '#38BDF8' }, isPremium: true, glowOverlay: true, effects: { twinklingStars: { enabled: true, count: 'dense', includeShootingStars: true, starColor: '#FFFFFF', animationDuration: 8 }, ambientEffects: { auroraWaves: true } } },
      { id: 'purple-twilight', name: 'Purple Twilight', category: 'christmas', colors: { '--cgpt-bg': '#0B0712', '--cgpt-surface': '#141021', '--cgpt-text': '#F9FAFB', '--cgpt-text-muted': '#E5E7EB', '--cgpt-border': '#4C1D95', '--cgpt-accent': '#7C3AED' }, isPremium: true, noiseOverlay: true, glowOverlay: true, effects: { twinklingStars: { enabled: true, count: 'sparse', starColor: '#FFFFFF', animationDuration: 10 }, ambientEffects: { candleGlow: true }, seasonalDecorations: { frostEdge: true } } },

      // PREMIUM THEMES - Christmas Pattern Collection (5)
      { id: 'snowfall-serenity', name: 'Snowfall Serenity', category: 'christmas', colors: { '--cgpt-bg': '#0F172A', '--cgpt-surface': '#1E293B', '--cgpt-text': '#F1F5F9', '--cgpt-text-muted': '#94A3B8', '--cgpt-border': '#334155', '--cgpt-accent': '#38BDF8' }, isPremium: true, noiseOverlay: true, glowOverlay: true, pattern: { type: 'snowflakes', opacity: 0.04, size: 1.2 }, effects: { animatedSnowfall: { enabled: true, density: 'medium', speed: 'slow', style: 'gentle' }, twinklingStars: { enabled: true, count: 'sparse', starColor: '#E0F2FE', animationDuration: 12 }, seasonalDecorations: { frostEdge: true } } },
      { id: 'holiday-gift-wrapping', name: 'Holiday Gift Wrapping', category: 'christmas', colors: { '--cgpt-bg': '#B83A4B', '--cgpt-surface': '#B83A4B90', '--cgpt-text': '#FFF8F5', '--cgpt-text-muted': '#FFE8E8', '--cgpt-border': '#9A3040', '--cgpt-accent': '#FFF8F5' }, isPremium: true, pattern: { type: 'dots', opacity: 0.35, color: '#FFF8F5', size: 3.0 }, effects: { seasonalDecorations: { ribbonBow: true, ribbonColor: '#FFF8F5' } } },
      { id: 'sage-forest-gift', name: 'Sage Forest Gift', category: 'christmas', colors: { '--cgpt-bg': '#9DB4A0', '--cgpt-surface': '#9DB4A090', '--cgpt-text': '#FFFFFF', '--cgpt-text-muted': '#F0F5F0', '--cgpt-border': '#7A9A7E', '--cgpt-accent': '#FFFFFF' }, isPremium: true, pattern: { type: 'christmastrees', opacity: 0.5, color: '#FFFFFF', size: 1.2 }, effects: { seasonalDecorations: { ribbonBow: true, ribbonColor: '#FFFFFF' } } },
      { id: 'festive-tree-gift', name: 'Festive Tree Gift', category: 'christmas', colors: { '--cgpt-bg': '#a31e39', '--cgpt-surface': '#0A0A0A50', '--cgpt-text': '#FFF8E1', '--cgpt-text-muted': '#D4C8B0', '--cgpt-border': '#FFFFFF30', '--cgpt-accent': '#FFD700' }, isPremium: true, pattern: { type: 'christmaswrap', opacity: 1.0, size: 1.0 } },
      { id: 'gingerbread-warmth', name: 'Gingerbread Warmth', category: 'christmas', colors: { '--cgpt-bg': '#1C120D', '--cgpt-surface': '#2A1B14', '--cgpt-text': '#FFF8E1', '--cgpt-text-muted': '#D7CCC8', '--cgpt-border': '#4E342E', '--cgpt-accent': '#FF8A65' }, isPremium: true, pattern: { type: 'dots', opacity: 0.05, color: '#A1887F', size: 1 } },
      { id: 'winter-wonderland', name: 'Winter Wonderland', category: 'christmas', colors: { '--cgpt-bg': '#E3F2FD', '--cgpt-surface': '#FFFFFF', '--cgpt-text': '#0D47A1', '--cgpt-text-muted': '#5472D3', '--cgpt-border': '#BBDEFB', '--cgpt-accent': '#1976D2' }, isPremium: true, effects: { animatedSnowfall: { enabled: true, density: 'heavy', speed: 'medium', style: 'shaking' }, seasonalDecorations: { frostEdge: true } } },
      { id: 'starry-christmas-eve', name: 'Starry Christmas Eve', category: 'christmas', colors: { '--cgpt-bg': '#0A0A1A', '--cgpt-surface': '#12122A', '--cgpt-text': '#FAFAFA', '--cgpt-text-muted': '#B8B8D1', '--cgpt-border': '#2A2A4A', '--cgpt-accent': '#FFD700' }, isPremium: true, effects: { twinklingStars: { enabled: true, count: 'dense', includeShootingStars: true } } },

      // PREMIUM THEMES - Core Collection (5)
      { id: 'synth-wave', name: 'Synth Wave', category: 'core', colors: { '--cgpt-bg': '#262335', '--cgpt-surface': '#2E2943', '--cgpt-text': '#F9FAFB', '--cgpt-text-muted': '#C7D2FE', '--cgpt-border': '#433162', '--cgpt-accent': '#FF6AC1' }, isPremium: true, glowOverlay: true, effects: { ambientEffects: { neonGrid: true } } },
      { id: 'apple-ii-phosphor', name: 'Apple II Phosphor', category: 'core', colors: { '--cgpt-bg': '#000000', '--cgpt-surface': '#0A120A', '--cgpt-text': '#33FF33', '--cgpt-text-muted': '#22AA22', '--cgpt-border': '#1A3A1A', '--cgpt-accent': '#00FF41' }, isPremium: true, noiseOverlay: true, glowOverlay: true },
      { id: 'tomorrow-night-blue', name: 'Tomorrow Night Blue', category: 'core', colors: { '--cgpt-bg': '#002451', '--cgpt-surface': '#001C40', '--cgpt-text': '#E0F2FF', '--cgpt-text-muted': '#BFDBFE', '--cgpt-border': '#003566', '--cgpt-accent': '#4FC3F7' }, isPremium: true, glowOverlay: true, effects: { twinklingStars: { enabled: true, count: 'sparse' } } },
      { id: 'shades-of-purple', name: 'Shades of Purple', category: 'core', colors: { '--cgpt-bg': '#2D2B56', '--cgpt-surface': '#222244', '--cgpt-text': '#FFFFFF', '--cgpt-text-muted': '#C7D2FE', '--cgpt-border': '#3F3C78', '--cgpt-accent': '#FAD000' }, isPremium: true },
      { id: 'dark-forest', name: 'Dark Forest', category: 'core', colors: { '--cgpt-bg': '#101917', '--cgpt-surface': '#131F1D', '--cgpt-text': '#E5F5F0', '--cgpt-text-muted': '#94A3B8', '--cgpt-border': '#1F2933', '--cgpt-accent': '#22C55E' }, isPremium: true, noiseOverlay: true, effects: { treeSilhouettes: { enabled: true, style: 'mixed', density: 'moderate' }, ambientEffects: { fogRising: true, firefliesOrParticles: true } } },
      { id: 'chocolate-caramel', name: 'Chocolate Caramel', category: 'core', colors: { '--cgpt-bg': '#221A0F', '--cgpt-surface': '#362712', '--cgpt-text': '#FDEFD9', '--cgpt-text-muted': '#D1B59A', '--cgpt-border': '#4A3419', '--cgpt-accent': '#FBBF77' }, isPremium: true, noiseOverlay: true },
    ];

    let currentTheme = null;
    let currentThemeIndex = 0;
    let dynamicStyleEl = null;
    let effectsEnabled = true;

    // === PATTERN GENERATORS (mirrors theme-injector.ts) ===
    function generatePatternCSS(pattern, accentColor) {
      if (!pattern) return '';
      const color = pattern.color || accentColor;
      const opacity = pattern.opacity;
      const size = pattern.size || 1;

      const dotRadius = Math.max(2, Math.round(2.5 * size));
      const dotSpacing = Math.round(25 * size);
      const patterns = {
        dots: {
          bg: `radial-gradient(${color} ${dotRadius}px, transparent ${dotRadius}px)`,
          size: `${dotSpacing}px ${dotSpacing}px`
        },
        grid: {
          bg: `linear-gradient(${color} 1px, transparent 1px), linear-gradient(90deg, ${color} 1px, transparent 1px)`,
          size: `${24 * size}px ${24 * size}px`
        },
        snowflakes: {
          bg: `radial-gradient(${color} 2px, transparent 2px), radial-gradient(${color} 1px, transparent 1px)`,
          size: `${50 * size}px ${50 * size}px, ${30 * size}px ${30 * size}px`,
          position: `0 0, ${15 * size}px ${15 * size}px`
        },
        stars: {
          bg: `radial-gradient(${color} 1.5px, transparent 1.5px), radial-gradient(${color} 1px, transparent 1px), radial-gradient(${color} 0.5px, transparent 0.5px)`,
          size: `${80 * size}px ${80 * size}px, ${60 * size}px ${60 * size}px, ${40 * size}px ${40 * size}px`,
          position: `0 0, ${30 * size}px ${40 * size}px, ${15 * size}px ${20 * size}px`
        },
        giftwrap: {
          bg: `radial-gradient(${color} 3px, transparent 3px), radial-gradient(${color} 2px, transparent 2px), repeating-linear-gradient(45deg, transparent, transparent 60px, ${color}33 60px, ${color}33 62px), repeating-linear-gradient(-45deg, transparent, transparent 60px, ${color}22 60px, ${color}22 62px)`,
          size: `${40 * size}px ${40 * size}px, ${25 * size}px ${25 * size}px, 100% 100%, 100% 100%`,
          position: `0 0, ${12 * size}px ${12 * size}px, 0 0, 0 0`
        },
        christmastrees: null,
        peppermints: null,
        christmaswrap: null,
        noise: null
      };

      // Handle Christmas trees pattern separately (needs SVG)
      if (pattern.type === 'christmastrees') {
        const treeSpacing = Math.round(100 * size);
        const treeSvg = `<svg xmlns='http://www.w3.org/2000/svg' width='${treeSpacing}' height='${treeSpacing}' viewBox='0 0 100 100'>
          <polygon points='50,8 35,35 42,35 30,55 38,55 22,80 78,80 62,55 70,55 58,35 65,35' fill='${color}' opacity='0.9'/>
          <rect x='45' y='80' width='10' height='12' fill='${color}' opacity='0.7'/>
          <circle cx='50' cy='15' r='3' fill='${color}' opacity='0.6'/>
          <circle cx='20' cy='20' r='1.5' fill='${color}' opacity='0.4'/>
          <circle cx='80' cy='30' r='1.5' fill='${color}' opacity='0.4'/>
          <circle cx='15' cy='70' r='1.5' fill='${color}' opacity='0.4'/>
          <circle cx='85' cy='85' r='1.5' fill='${color}' opacity='0.4'/>
        </svg>`;
        const treeEncoded = btoa(treeSvg);
        return `body::before { background-image: url('data:image/svg+xml;base64,${treeEncoded}'); background-size: ${treeSpacing}px ${treeSpacing}px; background-position: ${Math.round(treeSpacing / 4)}px ${Math.round(treeSpacing / 4)}px; opacity: ${opacity}; z-index: -1; }`;
      }

      // Handle peppermints pattern separately (needs SVG)
      if (pattern.type === 'peppermints') {
        const mintSpacing = Math.round(80 * size);
        const mintSvg = `<svg xmlns='http://www.w3.org/2000/svg' width='${mintSpacing}' height='${mintSpacing}' viewBox='0 0 80 80'>
          <defs>
            <clipPath id='mintClip'>
              <circle cx='40' cy='40' r='22'/>
            </clipPath>
          </defs>
          <circle cx='40' cy='40' r='24' fill='#FFFFFF' opacity='0.95'/>
          <g clip-path='url(#mintClip)'>
            <path d='M40,18 L40,62 L52,62 L52,18 Z' fill='${color}' opacity='0.9'/>
            <path d='M40,18 L28,18 L28,62 L40,62 Z' fill='${color}' opacity='0.9' transform='rotate(60,40,40)'/>
            <path d='M40,18 L28,18 L28,62 L40,62 Z' fill='${color}' opacity='0.9' transform='rotate(120,40,40)'/>
            <path d='M40,18 L52,18 L52,62 L40,62 Z' fill='${color}' opacity='0.9' transform='rotate(180,40,40)'/>
            <path d='M40,18 L52,18 L52,62 L40,62 Z' fill='${color}' opacity='0.9' transform='rotate(240,40,40)'/>
            <path d='M40,18 L52,18 L52,62 L40,62 Z' fill='${color}' opacity='0.9' transform='rotate(300,40,40)'/>
          </g>
          <circle cx='40' cy='40' r='22' fill='none' stroke='#FFFFFF' stroke-width='2' opacity='0.5'/>
        </svg>`;
        const mintEncoded = btoa(mintSvg);
        return `body::before { background-image: url('data:image/svg+xml;base64,${mintEncoded}'); background-size: ${mintSpacing}px ${mintSpacing}px; background-position: ${Math.round(mintSpacing / 4)}px ${Math.round(mintSpacing / 4)}px; opacity: ${opacity}; z-index: -1; }`;
      }

      // Handle Christmas wrap pattern (pure CSS conic gradients)
      if (pattern.type === 'christmaswrap') {
        const s = Math.round(132 * size);
        const c1 = '#ffffff';
        const c2 = '#a31e39';
        const c3 = '#31570e';
        return `body::before {
          --s: ${s}px;
          --c1: ${c1};
          --c2: ${c2};
          --c3: ${c3};
          --_c: #0000, var(--c1) 1deg 79deg, #0000 81deg;
          --g0: conic-gradient(from 140deg at 50% 87.5%, var(--_c));
          --g1: conic-gradient(from 140deg at 50% 81.25%, var(--_c));
          --g2: conic-gradient(from 140deg at 50% 75%, var(--_c));
          --g3: conic-gradient(at 10% 20%, #0000 75%, var(--c1) 0);
          background:
            var(--g0) 0 calc(var(--s) / -4),
            var(--g0) var(--s) calc(3 * var(--s) / 4),
            var(--g1),
            var(--g1) var(--s) var(--s),
            var(--g2) 0 calc(var(--s) / 4),
            var(--g2) var(--s) calc(5 * var(--s) / 4),
            var(--g3) calc(var(--s) / -10) var(--s),
            var(--g3) calc(9 * var(--s) / 10) calc(2 * var(--s)),
            repeating-conic-gradient(from 45deg, var(--c2) 0 25%, var(--c3) 0 50%);
          background-size: calc(2 * var(--s)) calc(2 * var(--s));
          opacity: ${opacity};
          z-index: -1;
        }`;
      }

      if (pattern.type === 'noise') {
        const svg = `<svg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23n)' opacity='${opacity}'/></svg>`;
        return `body::before { background-image: url("data:image/svg+xml,${encodeURIComponent(svg)}"); z-index: -1; }`;
      }

      const p = patterns[pattern.type];
      if (!p) return '';
      // Add offset for dots pattern to avoid alignment with ribbon, or use pattern-specific position
      let positionStyle = '';
      if (pattern.type === 'dots') {
        positionStyle = `background-position: ${Math.round(dotSpacing / 3)}px ${Math.round(dotSpacing / 3)}px;`;
      } else if (p.position) {
        positionStyle = `background-position: ${p.position};`;
      }
      return `body::before { background-image: ${p.bg}; background-size: ${p.size}; ${positionStyle} opacity: ${opacity}; z-index: -1; }`;
    }

    function generateNoiseOverlay() {
      const svg = `<svg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>`;
      return `body::after { background-image: url("data:image/svg+xml,${encodeURIComponent(svg)}"); opacity: 0.035; }`;
    }

    function generateGlowOverlay(accentColor) {
      return `body::after { background-image: radial-gradient(ellipse 80% 50% at 50% 0%, ${accentColor} 0%, transparent 50%), radial-gradient(ellipse 60% 40% at 20% 100%, ${accentColor} 0%, transparent 40%); opacity: 0.08; }`;
    }

    // === EFFECTS GENERATORS (mirrors theme-injector.ts) ===
    function generateEffectsCSS(effects, accentColor) {
      if (!effects || !effectsEnabled) return '';
      const cssBlocks = [];

      // Animated snowfall - supports three styles: gentle, shaking, gradient
      if (effects.animatedSnowfall?.enabled) {
        const snow = effects.animatedSnowfall;
        const style = snow.style || 'gentle';
        const count = snow.density === 'heavy' ? 40 : snow.density === 'medium' ? 25 : 12;
        const duration = snow.speed === 'fast' ? 8 : snow.speed === 'medium' ? 12 : 18;
        const snowColor = snow.snowColor || 'white';

        if (style === 'gradient') {
          // Pattern 3: Pure CSS radial gradient snowfall (no DOM elements)
          cssBlocks.push(`
.themegpt-snow-gradient {
  position: fixed;
  top: -600px;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: -1;
  background-image: radial-gradient(5px 5px at 34px 172px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 86px 25px, ${snowColor} 50%, transparent 50%), radial-gradient(5px 5px at 388px 47px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 53px 303px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 373px 475px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 196px 261px, ${snowColor} 50%, transparent 50%), radial-gradient(5px 5px at 434px 424px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 234px 213px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 393px 356px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 537px 497px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 151px 362px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 110px 99px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 270px 111px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 351px 424px, ${snowColor} 50%, transparent 50%), radial-gradient(5px 5px at 459px 279px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 584px 126px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 303px 486px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 132px 292px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 120px 162px, ${snowColor} 50%, transparent 50%), radial-gradient(5px 5px at 396px 460px, ${snowColor} 50%, transparent 50%), radial-gradient(5px 5px at 169px 508px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 177px 298px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 575px 410px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 29px 140px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 82px 378px, ${snowColor} 50%, transparent 50%), radial-gradient(4px 4px at 482px 473px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 56px 24px, ${snowColor} 50%, transparent 50%), radial-gradient(3px 3px at 157px 73px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 97px 496px, ${snowColor} 50%, transparent 50%), radial-gradient(6px 6px at 240px 225px, ${snowColor} 50%, transparent 50%);
  background-size: 600px 600px;
  animation: themegpt-snow-gradient ${duration}s linear infinite;
  opacity: 0.7;
}
@keyframes themegpt-snow-gradient {
  0% { background-position: 0px 0px; }
  100% { background-position: 500px 1000px; }
}`);
        } else if (style === 'shaking') {
          // Pattern 2: Snowflakes with horizontal shake
          let snowflakesCSS = '';
          const positions = [1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 25, 65];
          const delays = [[0,0], [1,1], [6,0.5], [4,2], [2,2], [8,3], [6,2], [2.5,1], [1,0], [3,1.5], [2,0], [4,2.5]];
          for (let i = 0; i < Math.min(count, 12); i++) {
            const left = positions[i] || Math.random() * 100;
            const [fallDelay, shakeDelay] = delays[i] || [Math.random() * 8, Math.random() * 3];
            snowflakesCSS += `.themegpt-snow-${i}{left:${left}%;animation-delay:${fallDelay}s,${shakeDelay}s;}`;
          }
          cssBlocks.push(`
@keyframes themegpt-snowfall-shake {
  0% { top: -10%; }
  100% { top: 100%; }
}
@keyframes themegpt-snow-shake {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(80px); }
}
.themegpt-snowflake {
  position: fixed;
  top: -10%;
  width: 8px;
  height: 8px;
  background: ${snowColor};
  border-radius: 50%;
  box-shadow: 0 0 6px ${snowColor};
  animation: themegpt-snowfall-shake ${duration}s linear infinite, themegpt-snow-shake 3s ease-in-out infinite;
  z-index: -1;
  pointer-events: none;
}
${snowflakesCSS}`);
        } else {
          // Pattern 1 (gentle): Slow, gentle descent with diagonal drift
          let snowflakesCSS = '';
          for (let i = 0; i < count; i++) {
            const left = Math.random() * 100;
            const delay = Math.random() * duration;
            const size = 2 + Math.random() * 4;
            const drift = 5 + Math.random() * 10; // Always drift right (diagonal-fall style)
            snowflakesCSS += `.themegpt-snow-${i}{left:${left}%;animation-delay:${delay}s;width:${size}px;height:${size}px;--drift:${drift}vw;}`;
          }
          cssBlocks.push(`
@keyframes themegpt-snowfall-gentle {
  0% { opacity: 0; transform: translate(0, 0); }
  10% { opacity: 0.8; }
  100% { opacity: 0.25; transform: translate(var(--drift, 10vw), 100vh); }
}
.themegpt-snowflake {
  position: fixed;
  top: -10px;
  background: ${snowColor};
  border-radius: 50%;
  animation: themegpt-snowfall-gentle ${duration}s linear infinite;
  box-shadow: 0 0 4px ${snowColor};
  z-index: -1;
  pointer-events: none;
}
${snowflakesCSS}`);
        }
      }

      // Twinkling stars
      if (effects.twinklingStars?.enabled) {
        const stars = effects.twinklingStars;
        const count = stars.count === 'dense' ? 50 : stars.count === 'medium' ? 30 : 15;
        const starColor = stars.starColor || accentColor;
        const baseDuration = stars.animationDuration || 3;

        let starsCSS = '';
        for (let i = 0; i < count; i++) {
          const left = Math.random() * 100;
          const top = Math.random() * 70;
          // Highly varied delays to desynchronize stars (spread across 5x base duration)
          const delay = Math.random() * (baseDuration * 5);
          const size = 1 + Math.random() * 2.5;
          // Wide duration variation (50%-150% of base) for organic feel
          const durationVariation = baseDuration * (0.5 + Math.random());
          // Vary the peak brightness per star
          const peakOpacity = 0.6 + Math.random() * 0.4;
          starsCSS += `.themegpt-star-${i}{left:${left}%;top:${top}%;animation-delay:${delay.toFixed(2)}s;animation-duration:${durationVariation.toFixed(2)}s;width:${size.toFixed(1)}px;height:${size.toFixed(1)}px;--peak-opacity:${peakOpacity.toFixed(2)};}`;
        }

        cssBlocks.push(`
/* Premium Effect: Twinkling Stars - Organic variation */
@keyframes themegpt-twinkle {
  0%, 100% { opacity: 0.15; transform: scale(0.7); }
  50% { opacity: var(--peak-opacity, 0.8); transform: scale(1.1); }
}
.themegpt-star {
  position: absolute;
  background: ${starColor};
  border-radius: 50%;
  animation: themegpt-twinkle ${baseDuration}s ease-in-out infinite;
  box-shadow: 0 0 3px ${starColor};
  --peak-opacity: 0.8;
}
${starsCSS}
${stars.includeShootingStars ? `
@keyframes themegpt-shooting {
  0% { transform: translateX(0) translateY(0); opacity: 1; }
  100% { transform: translateX(150px) translateY(100px); opacity: 0; }
}
.themegpt-shooting-star {
  position: absolute;
  width: 2px;
  height: 2px;
  background: linear-gradient(90deg, white, transparent);
  animation: themegpt-shooting 2s ease-out infinite;
}
.themegpt-shooting-star-1 { top: 15%; left: 20%; animation-delay: 3s; }
.themegpt-shooting-star-2 { top: 25%; left: 60%; animation-delay: 7s; }` : ''}`);
      }

      // Tree silhouettes
      if (effects.treeSilhouettes?.enabled) {
        const trees = effects.treeSilhouettes;
        const count = trees.density === 'forest' ? 8 : trees.density === 'moderate' ? 5 : 3;
        const isChristmas = trees.style === 'christmas';

        let treesCSS = '';
        for (let i = 0; i < count; i++) {
          const left = (i / count) * 80 + Math.random() * 15;
          const height = isChristmas ? 90 + Math.random() * 50 : 60 + Math.random() * 80;
          const width = height * (isChristmas ? 0.5 : 0.6);
          // Christmas trees: subtle background silhouettes with depth variation
          const opacity = isChristmas ? 0.12 + (i / count) * 0.18 : 0.15 + (i / count) * 0.25;
          treesCSS += `.themegpt-tree-${i}{left:${left}%;height:${height}px;width:${width}px;opacity:${opacity};}`;
        }

        if (isChristmas) {
          cssBlocks.push(`
/* Refined Pine Silhouettes */
.themegpt-tree {
  position: absolute;
  bottom: 0;
  z-index: 1;
}
.themegpt-tree::before {
  content: '';
  position: absolute;
  bottom: 8%;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  height: 92%;
  background: rgba(0, 0, 0, 0.7);
  clip-path: polygon(
    50% 0%,
    47% 12%, 35% 18%, 44% 20%,
    30% 32%, 42% 34%,
    22% 48%, 38% 50%,
    12% 68%, 35% 70%,
    5% 88%, 32% 88%,
    25% 100%, 75% 100%,
    68% 88%, 95% 88%,
    65% 70%, 88% 68%,
    62% 50%, 78% 48%,
    58% 34%, 70% 32%,
    56% 20%, 65% 18%, 53% 12%
  );
}
.themegpt-tree::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 12%;
  height: 10%;
  background: rgba(40, 25, 15, 0.8);
  border-radius: 0 0 2px 2px;
}
${treesCSS}`);
        } else {
          const pineClipPath = trees.style === 'pine' || trees.style === 'mixed'
            ? 'polygon(50% 0%, 45% 15%, 30% 15%, 40% 30%, 20% 30%, 35% 45%, 10% 45%, 30% 60%, 5% 60%, 25% 75%, 0% 80%, 40% 100%, 60% 100%, 100% 80%, 75% 75%, 95% 60%, 70% 60%, 90% 45%, 65% 45%, 80% 30%, 60% 30%, 70% 15%, 55% 15%)'
            : 'polygon(50% 0%, 0% 100%, 100% 100%)';
          cssBlocks.push(`
.themegpt-tree {
  position: absolute;
  bottom: 0;
  clip-path: ${pineClipPath};
  background: rgba(0,0,0,0.8);
  z-index: 1;
}
${treesCSS}`);
        }
      }

      // Ambient effects
      if (effects.ambientEffects?.fogRising) {
        cssBlocks.push(`
@keyframes themegpt-fog {
  0%, 100% { transform: translateY(0); opacity: 0.4; }
  50% { transform: translateY(-20px); opacity: 0.6; }
}
.themegpt-fog {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 150px;
  background: linear-gradient(to top, rgba(255,255,255,0.15), transparent);
  animation: themegpt-fog 8s ease-in-out infinite;
}
@media (prefers-reduced-motion: reduce) { .themegpt-fog { animation: none; } }`);
      }

      if (effects.ambientEffects?.neonGrid) {
        cssBlocks.push(`
.themegpt-neon-grid {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(${accentColor}22 1px, transparent 1px),
    linear-gradient(90deg, ${accentColor}22 1px, transparent 1px);
  background-size: 40px 40px;
  transform: perspective(500px) rotateX(60deg);
  transform-origin: center bottom;
  opacity: 0.4;
}`);
      }

      if (effects.ambientEffects?.auroraWaves) {
        cssBlocks.push(`
@keyframes themegpt-aurora {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.themegpt-aurora {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 30%;
  background: linear-gradient(90deg,
    rgba(0,255,200,0.1),
    rgba(100,200,255,0.15),
    rgba(180,100,255,0.1),
    rgba(0,255,200,0.1));
  background-size: 300% 100%;
  animation: themegpt-aurora 15s ease-in-out infinite;
  filter: blur(30px);
}
@media (prefers-reduced-motion: reduce) { .themegpt-aurora { animation: none; } }`);
      }

      if (effects.ambientEffects?.candleGlow) {
        cssBlocks.push(`
/* Premium Effect: Candle Glow */
.themegpt-candle-glow {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    radial-gradient(ellipse 30% 40% at 10% 90%, rgba(255,183,77,0.08) 0%, transparent 70%),
    radial-gradient(ellipse 25% 35% at 90% 85%, rgba(255,183,77,0.06) 0%, transparent 70%),
    radial-gradient(ellipse 20% 30% at 50% 95%, rgba(255,152,0,0.05) 0%, transparent 60%);
}`);
      }

      // Seasonal decorations
      if (effects.seasonalDecorations?.frostEdge) {
        cssBlocks.push(`
.themegpt-frost {
  position: absolute;
  inset: 0;
  pointer-events: none;
  box-shadow: inset 0 0 100px 20px rgba(200,220,255,0.15);
}`);
      }

      if (effects.seasonalDecorations?.candyCaneFrame) {
        cssBlocks.push(`
/* Premium Effect: Candy Cane Frame - Static */
.themegpt-candy-frame {
  position: absolute;
  inset: 0;
  pointer-events: none;
  border: 10px solid transparent;
  background: repeating-linear-gradient(
    -45deg,
    #fff 0 5px,
    #dc2626 5px 10px
  );
  -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0.6;
}`);
      }

      if (effects.seasonalDecorations?.sparkleOverlay) {
        // Generate sparkle positions
        let sparklesCSS = '';
        for (let i = 0; i < 20; i++) {
          const left = Math.random() * 100;
          const top = Math.random() * 100;
          const delay = Math.random() * 4;
          const size = 2 + Math.random() * 4;
          sparklesCSS += `.themegpt-sparkle-${i}{left:${left}%;top:${top}%;animation-delay:${delay.toFixed(2)}s;width:${size}px;height:${size}px;}`;
        }

        // Use red sparkles for light backgrounds (candy cane theme), white for dark
        const sparkleColor = effects.seasonalDecorations.sparkleColor || 'white';
        const isRedSparkle = sparkleColor !== 'white';
        const shadowColor = isRedSparkle ? 'rgba(220,38,38,0.6)' : 'white';

        cssBlocks.push(`
/* Premium Effect: Festive Sparkles */
@keyframes themegpt-sparkle {
  0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
  50% { opacity: 1; transform: scale(1) rotate(180deg); }
}
.themegpt-sparkle {
  position: absolute;
  background: ${sparkleColor};
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  animation: themegpt-sparkle 3s ease-in-out infinite;
  filter: drop-shadow(0 0 3px ${shadowColor});
}
${sparklesCSS}
@media (prefers-reduced-motion: reduce) { .themegpt-sparkle { animation: none; opacity: 0.4; } }`);
      }

      if (effects.seasonalDecorations?.frostedGlass) {
        cssBlocks.push(`
/* Premium Effect: Frosted Window - Simplified for clarity */
/* Heavy frost vignette creeping from edges */
.themegpt-frost-vignette {
  position: absolute;
  inset: 0;
  pointer-events: none;
  box-shadow:
    /* Outer frost ring - prominent white frost */
    inset 0 0 80px 30px rgba(220,235,255,0.6),
    inset 0 0 150px 60px rgba(200,220,245,0.35),
    /* Subtle inner glow */
    inset 0 0 200px 80px rgba(180,210,240,0.15);
}
/* Condensation water droplets - the recognizable "frosted window" element */
.themegpt-condensation {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 180px;
  pointer-events: none;
  background:
    /* Large prominent droplets */
    radial-gradient(ellipse 8px 12px at 8% 75%, rgba(150,180,220,0.7) 0%, rgba(130,165,210,0.3) 50%, transparent 100%),
    radial-gradient(ellipse 10px 14px at 25% 85%, rgba(160,190,230,0.65) 0%, rgba(140,175,220,0.25) 45%, transparent 100%),
    radial-gradient(ellipse 7px 10px at 42% 70%, rgba(155,185,225,0.6) 0%, rgba(135,170,215,0.2) 50%, transparent 100%),
    radial-gradient(ellipse 12px 16px at 60% 82%, rgba(165,195,235,0.7) 0%, rgba(145,180,225,0.3) 40%, transparent 100%),
    radial-gradient(ellipse 6px 9px at 75% 90%, rgba(150,180,220,0.55) 0%, rgba(130,165,210,0.2) 55%, transparent 100%),
    radial-gradient(ellipse 9px 13px at 90% 78%, rgba(158,188,228,0.6) 0%, rgba(138,173,218,0.25) 50%, transparent 100%),
    /* Water trails running down */
    radial-gradient(ellipse 3px 50px at 8% 100%, rgba(140,175,215,0.5) 0%, transparent 100%),
    radial-gradient(ellipse 3px 65px at 25% 100%, rgba(145,180,220,0.45) 0%, transparent 100%),
    radial-gradient(ellipse 2px 40px at 42% 100%, rgba(135,170,210,0.4) 0%, transparent 100%),
    radial-gradient(ellipse 4px 80px at 60% 100%, rgba(150,185,225,0.5) 0%, transparent 100%),
    radial-gradient(ellipse 2px 35px at 75% 100%, rgba(138,173,213,0.35) 0%, transparent 100%),
    radial-gradient(ellipse 3px 55px at 90% 100%, rgba(142,177,217,0.45) 0%, transparent 100%);
}`);
      }

      if (effects.seasonalDecorations?.ribbonBow) {
        const ribbonColor = effects.seasonalDecorations.ribbonColor || '#FFFFFF';
        cssBlocks.push(`
/* Premium Effect: Gift Ribbon with Bow */
.themegpt-ribbon-vertical {
  position: fixed;
  left: 260px;
  top: 0;
  bottom: 0;
  width: 24px;
  pointer-events: none;
  z-index: 5;
  background: linear-gradient(90deg,
    transparent 0%,
    ${ribbonColor}15 10%,
    ${ribbonColor}40 25%,
    ${ribbonColor}60 50%,
    ${ribbonColor}40 75%,
    ${ribbonColor}15 90%,
    transparent 100%);
  box-shadow: 0 0 8px ${ribbonColor}30;
}
.themegpt-bow {
  position: fixed;
  left: 236px;
  top: 80px;
  width: 72px;
  height: 48px;
  pointer-events: none;
  z-index: 6;
}
.themegpt-bow::before,
.themegpt-bow::after {
  content: '';
  position: absolute;
  width: 28px;
  height: 20px;
  border-radius: 50% 50% 50% 50%;
  background: linear-gradient(135deg, ${ribbonColor}90 0%, ${ribbonColor}60 100%);
  box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}
.themegpt-bow::before {
  left: 4px;
  top: 14px;
  transform: rotate(-25deg);
}
.themegpt-bow::after {
  right: 4px;
  top: 14px;
  transform: rotate(25deg);
}
.themegpt-bow-knot {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 16px;
  height: 14px;
  background: ${ribbonColor};
  border-radius: 4px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.themegpt-bow-tail-left,
.themegpt-bow-tail-right {
  position: absolute;
  top: 32px;
  width: 10px;
  height: 30px;
  background: linear-gradient(180deg, ${ribbonColor}80 0%, ${ribbonColor}50 100%);
  border-radius: 0 0 4px 4px;
}
.themegpt-bow-tail-left {
  left: 24px;
  transform: rotate(-8deg);
}
.themegpt-bow-tail-right {
  right: 24px;
  transform: rotate(8deg);
}`);
      }

      return cssBlocks.join('\n');
    }

    function createEffectsElements(effects) {
      const container = document.getElementById('themegpt-effects');
      container.innerHTML = '';

      if (!effects || !effectsEnabled) return;

      // Add snowflakes based on style
      if (effects.animatedSnowfall?.enabled) {
        const style = effects.animatedSnowfall.style || 'gentle';

        if (style === 'gradient') {
          // Gradient style uses a single div with CSS background
          const gradientDiv = document.createElement('div');
          gradientDiv.className = 'themegpt-snow-gradient';
          container.appendChild(gradientDiv);
        } else {
          // Gentle and shaking styles use individual snowflake elements
          const count = style === 'shaking' ? 12 :
                        (effects.animatedSnowfall.density === 'heavy' ? 40 :
                         effects.animatedSnowfall.density === 'medium' ? 25 : 12);
          for (let i = 0; i < count; i++) {
            const flake = document.createElement('div');
            flake.className = `themegpt-snowflake themegpt-snow-${i}`;
            container.appendChild(flake);
          }
        }
      }

      // Add stars
      if (effects.twinklingStars?.enabled) {
        const count = effects.twinklingStars.count === 'dense' ? 50 :
                      effects.twinklingStars.count === 'medium' ? 30 : 15;
        for (let i = 0; i < count; i++) {
          const star = document.createElement('div');
          star.className = `themegpt-star themegpt-star-${i}`;
          container.appendChild(star);
        }
        if (effects.twinklingStars.includeShootingStars) {
          for (let i = 1; i <= 2; i++) {
            const shooting = document.createElement('div');
            shooting.className = `themegpt-shooting-star themegpt-shooting-star-${i}`;
            container.appendChild(shooting);
          }
        }
      }

      // Add trees
      if (effects.treeSilhouettes?.enabled) {
        const trees = effects.treeSilhouettes;
        const count = trees.density === 'forest' ? 8 : trees.density === 'moderate' ? 5 : 3;

        for (let i = 0; i < count; i++) {
          const tree = document.createElement('div');
          tree.className = `themegpt-tree themegpt-tree-${i}`;
          container.appendChild(tree);
        }
      }

      // Add ambient effects
      if (effects.ambientEffects?.fogRising) {
        const fog = document.createElement('div');
        fog.className = 'themegpt-fog';
        container.appendChild(fog);
      }
      if (effects.ambientEffects?.neonGrid) {
        const grid = document.createElement('div');
        grid.className = 'themegpt-neon-grid';
        container.appendChild(grid);
      }
      if (effects.ambientEffects?.auroraWaves) {
        const aurora = document.createElement('div');
        aurora.className = 'themegpt-aurora';
        container.appendChild(aurora);
      }
      if (effects.ambientEffects?.candleGlow) {
        const glow = document.createElement('div');
        glow.className = 'themegpt-candle-glow';
        container.appendChild(glow);
      }

      // Add seasonal decorations
      if (effects.seasonalDecorations?.frostEdge) {
        const frost = document.createElement('div');
        frost.className = 'themegpt-frost';
        container.appendChild(frost);
      }
      if (effects.seasonalDecorations?.candyCaneFrame) {
        const frame = document.createElement('div');
        frame.className = 'themegpt-candy-frame';
        container.appendChild(frame);
      }
      if (effects.seasonalDecorations?.sparkleOverlay) {
        for (let i = 0; i < 20; i++) {
          const sparkle = document.createElement('div');
          sparkle.className = `themegpt-sparkle themegpt-sparkle-${i}`;
          container.appendChild(sparkle);
        }
      }
      if (effects.seasonalDecorations?.frostedGlass) {
        // Heavy frost vignette from edges
        const vignette = document.createElement('div');
        vignette.className = 'themegpt-frost-vignette';
        container.appendChild(vignette);

        // Condensation droplets at bottom
        const condensation = document.createElement('div');
        condensation.className = 'themegpt-condensation';
        container.appendChild(condensation);
      }
      if (effects.seasonalDecorations?.ribbonBow) {
        // Vertical ribbon at sidebar edge
        const ribbon = document.createElement('div');
        ribbon.className = 'themegpt-ribbon-vertical';
        container.appendChild(ribbon);

        // Bow at top of ribbon
        const bow = document.createElement('div');
        bow.className = 'themegpt-bow';
        const knot = document.createElement('div');
        knot.className = 'themegpt-bow-knot';
        const tailLeft = document.createElement('div');
        tailLeft.className = 'themegpt-bow-tail-left';
        const tailRight = document.createElement('div');
        tailRight.className = 'themegpt-bow-tail-right';
        bow.appendChild(knot);
        bow.appendChild(tailLeft);
        bow.appendChild(tailRight);
        container.appendChild(bow);
      }
    }

    // === QUALITY CHECKS ===
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)] : [0, 0, 0];
    }

    function getLuminance(hex) {
      const rgb = hexToRgb(hex);
      const [r, g, b] = rgb.map(c => {
        c = c / 255;
        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
      });
      return 0.2126 * r + 0.7152 * g + 0.0722 * b;
    }

    function getContrastRatio(hex1, hex2) {
      const l1 = getLuminance(hex1);
      const l2 = getLuminance(hex2);
      return (Math.max(l1, l2) + 0.05) / (Math.min(l1, l2) + 0.05);
    }

    function runQualityChecks(theme) {
      const checks = [];
      const c = theme.colors;

      const textContrast = getContrastRatio(c['--cgpt-bg'], c['--cgpt-text']);
      checks.push({ name: 'Text Contrast', pass: textContrast >= 4.5, value: textContrast.toFixed(2), target: '>= 4.5' });

      const mutedContrast = getContrastRatio(c['--cgpt-bg'], c['--cgpt-text-muted']);
      checks.push({ name: 'Muted Contrast', pass: mutedContrast >= 3, value: mutedContrast.toFixed(2), target: '>= 3.0' });

      const accentContrast = getContrastRatio(c['--cgpt-bg'], c['--cgpt-accent']);
      checks.push({ name: 'Accent Visibility', pass: accentContrast >= 3, value: accentContrast.toFixed(2), target: '>= 3.0' });

      if (theme.pattern) {
        checks.push({ name: 'Pattern Opacity', pass: theme.pattern.opacity <= 0.15, value: theme.pattern.opacity.toString(), target: '<= 0.15' });
      }

      if (theme.effects) {
        checks.push({ name: 'Has Effects', pass: true, value: 'Yes', target: 'Premium' });
      }

      return checks;
    }

    function displayQualityChecks(checks) {
      const container = document.getElementById('qualityChecks');
      container.innerHTML = checks.map(check => `
        <div class="check-item ${check.pass ? 'pass' : 'fail'}">
          <span>${check.name}</span>
          <span>${check.value} ${check.pass ? '' : ''}</span>
        </div>
      `).join('');
    }

    // === THEME APPLICATION ===
    function applyTheme(theme) {
      currentTheme = theme;
      currentThemeIndex = THEMES.findIndex(t => t.id === theme.id);
      const root = document.documentElement;

      // Apply CSS variables
      Object.entries(theme.colors).forEach(([prop, value]) => {
        root.style.setProperty(prop, value);
      });

      // Generate pattern and overlay CSS
      let additionalCSS = '';
      if (theme.pattern) {
        additionalCSS += generatePatternCSS(theme.pattern, theme.colors['--cgpt-accent']);
      }
      if (theme.noiseOverlay) {
        additionalCSS += generateNoiseOverlay();
      } else if (theme.glowOverlay) {
        additionalCSS += generateGlowOverlay(theme.colors['--cgpt-accent']);
      }

      // Generate effects CSS
      if (theme.effects) {
        additionalCSS += generateEffectsCSS(theme.effects, theme.colors['--cgpt-accent']);
      }

      // Apply dynamic styles
      if (!dynamicStyleEl) {
        dynamicStyleEl = document.createElement('style');
        dynamicStyleEl.id = 'dynamic-theme';
        document.head.appendChild(dynamicStyleEl);
      }
      dynamicStyleEl.textContent = additionalCSS;

      // Create effects DOM elements
      createEffectsElements(theme.effects);

      // Update UI
      document.getElementById('themeName').textContent = theme.name;

      let info = theme.isPremium ? 'Premium' : 'Free';
      if (theme.pattern) info += ` | Pattern: ${theme.pattern.type}`;
      if (theme.noiseOverlay) info += ' | Noise';
      if (theme.glowOverlay) info += ' | Glow';
      if (theme.effects) {
        const fx = [];
        if (theme.effects.animatedSnowfall?.enabled) fx.push('Snow');
        if (theme.effects.twinklingStars?.enabled) fx.push('Stars');
        if (theme.effects.treeSilhouettes?.enabled) fx.push('Trees');
        if (theme.effects.ambientEffects?.fogRising) fx.push('Fog');
        if (theme.effects.ambientEffects?.neonGrid) fx.push('Neon');
        if (theme.effects.ambientEffects?.auroraWaves) fx.push('Aurora');
        if (theme.effects.seasonalDecorations?.frostEdge) fx.push('Frost');
        if (theme.effects.seasonalDecorations?.candyCaneFrame) fx.push('Candy');
        if (theme.effects.seasonalDecorations?.frostedGlass) fx.push('FrostedGlass');
        if (theme.effects.seasonalDecorations?.ribbonBow) fx.push('Ribbon');
        if (fx.length) info += ` | FX: ${fx.join(', ')}`;
      }
      document.getElementById('themeInfo').textContent = info;

      // Update active button
      document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.themeId === theme.id);
      });

      // Run quality checks
      const checks = runQualityChecks(theme);
      displayQualityChecks(checks);

      // Log for debugging
      console.log(`[ThemeGPT] Applied: ${theme.id}`, { checks, effects: theme.effects });
    }

    // === INITIALIZATION ===
    function init() {
      const freeGrid = document.getElementById('freeThemes');
      const premiumGrid = document.getElementById('premiumThemes');

      const freeThemes = THEMES.filter(t => !t.isPremium);
      const premiumThemes = THEMES.filter(t => t.isPremium);

      // Update stats
      document.getElementById('totalCount').textContent = THEMES.length;
      document.getElementById('freeCount').textContent = freeThemes.length;
      document.getElementById('premiumCount').textContent = premiumThemes.length;

      THEMES.forEach(theme => {
        const btn = document.createElement('button');
        btn.className = 'theme-btn';
        btn.dataset.themeId = theme.id;
        btn.style.background = theme.colors['--cgpt-bg'];
        btn.style.color = theme.colors['--cgpt-text'];

        let badges = '';
        if (theme.effects) badges += '<span class="effects-badge">FX</span>';
        if (theme.pattern) badges += '<span class="effects-badge">PTN</span>';

        btn.innerHTML = `
          <div class="name">${theme.name}</div>
          <div class="accent-bar" style="background:${theme.colors['--cgpt-accent']}"></div>
          ${badges}
        `;
        btn.addEventListener('click', () => applyTheme(theme));

        if (theme.isPremium) {
          premiumGrid.appendChild(btn);
        } else {
          freeGrid.appendChild(btn);
        }
      });

      // Controls
      document.getElementById('exportBtn').addEventListener('click', () => {
        if (currentTheme) {
          const json = JSON.stringify(currentTheme, null, 2);
          console.log('[ThemeGPT] Export:', json);
          navigator.clipboard?.writeText(json).then(() => alert('Copied to clipboard!'));
        }
      });

      document.getElementById('toggleEffectsBtn').addEventListener('click', () => {
        effectsEnabled = !effectsEnabled;
        if (currentTheme) applyTheme(currentTheme);
        console.log(`[ThemeGPT] Effects ${effectsEnabled ? 'enabled' : 'disabled'}`);
      });

      document.getElementById('hideBtn').addEventListener('click', togglePanel);

      // Keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === 'h') { e.preventDefault(); togglePanel(); }
        if (e.ctrlKey && e.key === 'e') { e.preventDefault(); console.log('[ThemeGPT] Export:', JSON.stringify(currentTheme, null, 2)); }
        if (e.key === 'ArrowRight') { navigateTheme(1); }
        if (e.key === 'ArrowLeft') { navigateTheme(-1); }
      });

      // Apply first theme
      applyTheme(THEMES[0]);
    }

    function navigateTheme(direction) {
      const newIndex = (currentThemeIndex + direction + THEMES.length) % THEMES.length;
      applyTheme(THEMES[newIndex]);
    }

    function togglePanel() {
      document.getElementById('themePanel').classList.toggle('hidden');
      console.log('[ThemeGPT] Panel toggled');
    }

    document.addEventListener('DOMContentLoaded', init);

    // === THEMEGPT AGENTIC API ===
    // Programmatic interface for LLM agent control
    window.ThemeGPT = {
      // Get current state
      getState() {
        return {
          theme: currentTheme ? { ...currentTheme } : null,
          effectsEnabled,
          themeIndex: currentThemeIndex,
          totalThemes: THEMES.length
        };
      },

      // Set a single color variable
      setColor(variable, value) {
        if (!currentTheme) return { success: false, error: 'No theme loaded' };
        const validVars = ['--cgpt-bg', '--cgpt-surface', '--cgpt-text', '--cgpt-text-muted', '--cgpt-border', '--cgpt-accent'];
        if (!validVars.includes(variable)) return { success: false, error: `Invalid variable. Use: ${validVars.join(', ')}` };
        currentTheme.colors[variable] = value;
        applyTheme(currentTheme);
        console.log(`[ThemeGPT] Set ${variable} = ${value}`);
        return { success: true, variable, value };
      },

      // Set multiple colors at once
      setColors(colors) {
        if (!currentTheme) return { success: false, error: 'No theme loaded' };
        Object.entries(colors).forEach(([k, v]) => { currentTheme.colors[k] = v; });
        applyTheme(currentTheme);
        console.log('[ThemeGPT] Set colors:', colors);
        return { success: true, colors };
      },

      // Set background pattern
      setPattern(pattern) {
        if (!currentTheme) return { success: false, error: 'No theme loaded' };
        currentTheme.pattern = pattern; // { type, opacity, color?, size? } or null
        applyTheme(currentTheme);
        console.log('[ThemeGPT] Set pattern:', pattern);
        return { success: true, pattern };
      },

      // Toggle overlay
      setOverlay(type) {
        if (!currentTheme) return { success: false, error: 'No theme loaded' };
        currentTheme.noiseOverlay = type === 'noise';
        currentTheme.glowOverlay = type === 'glow';
        applyTheme(currentTheme);
        console.log('[ThemeGPT] Set overlay:', type);
        return { success: true, overlay: type };
      },

      // Apply a preset theme by ID
      apply(themeId) {
        const theme = THEMES.find(t => t.id === themeId);
        if (!theme) return { success: false, error: `Theme not found: ${themeId}`, available: THEMES.map(t => t.id) };
        applyTheme(theme);
        return { success: true, theme: theme.name };
      },

      // List all available themes
      list() {
        return THEMES.map(t => ({ id: t.id, name: t.name, isPremium: t.isPremium, hasEffects: !!t.effects }));
      },

      // Export current theme as JSON
      export() {
        const json = JSON.stringify(currentTheme, null, 2);
        console.log('[ThemeGPT] Export:', json);
        return currentTheme;
      },

      // Run quality checks
      validate() {
        if (!currentTheme) return { success: false, error: 'No theme loaded' };
        const checks = runQualityChecks(currentTheme);
        const allPass = checks.every(c => c.pass);
        console.log('[ThemeGPT] Validate:', { allPass, checks });
        return { success: true, allPass, checks };
      },

      // Toggle effects
      toggleEffects() {
        effectsEnabled = !effectsEnabled;
        if (currentTheme) applyTheme(currentTheme);
        console.log(`[ThemeGPT] Effects ${effectsEnabled ? 'enabled' : 'disabled'}`);
        return { effectsEnabled };
      },

      // Create a new theme from scratch
      create(config) {
        const newTheme = {
          id: config.id || `custom-${Date.now()}`,
          name: config.name || 'Custom Theme',
          category: 'custom',
          colors: config.colors || { ...THEMES[0].colors },
          isPremium: true,
          pattern: config.pattern || null,
          noiseOverlay: config.noiseOverlay || false,
          glowOverlay: config.glowOverlay || false,
          effects: config.effects || null
        };
        applyTheme(newTheme);
        console.log('[ThemeGPT] Created:', newTheme.name);
        return { success: true, theme: newTheme };
      }
    };

    console.log('[ThemeGPT] Agentic API ready. Use ThemeGPT.getState(), ThemeGPT.setColor(), etc.');
  </script>
</body>
</html>
